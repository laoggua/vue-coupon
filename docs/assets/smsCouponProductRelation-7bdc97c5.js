import{aM as m,aN as z,f as w,t as y,D as P,F as u,S as t,x as a,O as S,Q as i}from"./index-4b440f30.js";import{c as E,d as _,e as F}from"./el-form-item-cbbf9778.js";import{l as k,v as s,q as v,w as I,x as R,y as N,E as T}from"./el-table-column-2271517e.js";const U=e=>m.request({url:"/mall/sms-coupon-product-relation/page",method:"POST",data:e}),$=e=>m.request({url:"/mall/sms-coupon-product-relation/add",method:"POST",data:e}),L=e=>m.request({url:"/mall/sms-coupon-product-relation/del/"+e.id,method:"GET"}),q=e=>m.request({url:"/mall/sms-coupon-product-relation/edit",method:"POST",data:e}),D=w({data(){return{products:[],page:{total:0,current:1,size:10},dialogFormVisible:!1,product:{},formLabelWidth:80}},mounted(){this.getCouponProductRelation(1)},methods:{toEdit(e){this.dialogFormVisible=!0,this.product=k(e)},getCouponProductRelation(e){const o={current:this.page.current,size:this.page.size};U(o).then(n=>{console.log(n);const g=n.data.page;this.products=g.records,this.page=g}).catch(n=>{console.log(n)})},currentchange(e){this.getCouponProductRelation(e),this.page.current=e},handleSizeChange(e){this.getCouponProductRelation(),this.products.size=e},toDel(e){console.log(e),L({id:e}).then(n=>{if(n.success)this.getCouponProductRelation(this.page.current),this.page.total%this.page.size==1?this.getCouponProductRelation(this.page.current-1):this.getCouponProductRelation(this.page.current);else return console.log(n.msg),!1}).catch(n=>{})},toAdd(){this.dialogFormVisible=!0,this.product={couponId:0,id:0,productId:0,productName:"",productSn:""}},toSave(){const e=this.product;e.id==0?$(e).then(o=>{if(o.success)this.dialogFormVisible=!1,this.getCouponProductRelation(this.page.current),s({message:"新增成功",type:"success"});else return s({message:"新增失败",type:"error"}),!1}).catch(o=>{s("网络错误联系管理员")}):q(e).then(o=>{if(o.success)this.dialogFormVisible=!1,this.getCouponProductRelation(this.page.current),s({message:"修改成功",type:"success"});else return s({message:"修改失败",type:"false"}),!1}).catch(o=>{s("网络错误联系管理员")})}}}),W={style:{margin:"0 20px"}},B=u("h2",null,"促销商品关联",-1),O={style:{margin:"30px 0"}},A={style:{margin:"10px 0"}},M={class:"dialog-footer"};function j(e,o,n,g,G,Q){const d=v,r=N,h=I,f=R,p=T,c=_,b=F,C=E;return y(),P(S,null,[u("div",W,[B,u("div",O,[t(d,{type:"primary",onClick:e.toAdd},{default:a(()=>[i("添加")]),_:1},8,["onClick"])]),t(h,{data:e.products,border:"",style:{width:"100%"}},{default:a(()=>[t(r,{prop:"id",label:"编号",width:"70px"}),t(r,{prop:"couponId",label:"优惠券编号",width:"170px"}),t(r,{prop:"productId",label:"商品编号",width:"170px"}),t(r,{prop:"productName",label:"商品名称"}),t(r,{prop:"productSn",label:"商品编码"}),t(r,{fixed:"right",label:"操作"},{default:a(l=>[t(d,{size:"small",onClick:V=>e.toEdit(l.row)},{default:a(()=>[i("编辑")]),_:2},1032,["onClick"]),t(d,{size:"small",type:"danger",onClick:V=>e.toDel(l.row.id)},{default:a(()=>[i("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),u("div",A,[t(f,{"current-page":e.page.current,"onUpdate:currentPage":o[0]||(o[0]=l=>e.page.current=l),"page-size":e.page.size,"onUpdate:pageSize":o[1]||(o[1]=l=>e.page.size=l),"page-sizes":[5,10,15,20],layout:"total, sizes, prev, pager, next, jumper",total:e.page.total,onSizeChange:e.handleSizeChange,onCurrentChange:e.currentchange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),t(C,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":o[7]||(o[7]=l=>e.dialogFormVisible=l),title:"促销产品关联编辑"},{footer:a(()=>[u("span",M,[t(d,{onClick:o[6]||(o[6]=l=>e.dialogFormVisible=!1)},{default:a(()=>[i("取消")]),_:1}),t(d,{type:"primary",onClick:e.toSave},{default:a(()=>[i("保存")]),_:1},8,["onClick"])])]),default:a(()=>[t(b,{model:e.product},{default:a(()=>[t(c,{label:"优惠券编号","label-width":e.formLabelWidth},{default:a(()=>[t(p,{modelValue:e.product.couponId,"onUpdate:modelValue":o[2]||(o[2]=l=>e.product.couponId=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),t(c,{label:"商品编号","label-width":e.formLabelWidth},{default:a(()=>[t(p,{modelValue:e.product.productId,"onUpdate:modelValue":o[3]||(o[3]=l=>e.product.productId=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),t(c,{label:"商品名称","label-width":e.formLabelWidth},{default:a(()=>[t(p,{modelValue:e.product.productName,"onUpdate:modelValue":o[4]||(o[4]=l=>e.product.productName=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),t(c,{label:"商品编码","label-width":e.formLabelWidth},{default:a(()=>[t(p,{modelValue:e.product.productSn,"onUpdate:modelValue":o[5]||(o[5]=l=>e.product.productSn=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const X=z(D,[["render",j]]);export{X as default};
